<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./echarts.min.js"></script>
    <script src="./utils.js"></script>
    <script src="./services.js"></script>
    <script>
      // 数据地址
      const url =
        "https://goat.genomehubs.org/api/v2/report?report=arc&x=assembly_span%20AND%20bioproject%3DPRJNA533106&rank=phylum%2Cclass%2Corder%2Cfamily%2Cgenus%2Cspecies&includeEstimates=true&excludeAncestral%5B0%5D=bioproject&excludeMissing%5B0%5D=bioproject&caption=%2A%2AEBP%20Umbrella%2A%2A%20-%20EBP%20taxa%20with%20assemblies%20out%20of%20all%20Eukaryotic%20taxa%20in%20INSDC&taxonomy=ncbi&result=taxon&queryId=HvJvG3Tffp";
      
      // 初始化图表
        function initEchart(data) {
        const chartDom = document.getElementById("chartContainer");
        const myChart = echarts.init(chartDom);
        const option = {
          polar: {
            radius: [30, "600%"],
            center: ["50%", "100%"],
          },
          angleAxis: {
            min: 0,
            max: 100,
            startAngle: 180,
            endAngle: 0,
            show: false,
          },
          radiusAxis: {
            type: "category",
            data: ["a", "b", "c", "d"],
            show: false,
          },
          tooltip: {},
          graphic: {
            type: "group",
            left: "670", // 假设图例在右侧，这里将自定义文本放在图例旁边
            top: "50", // 垂直居中
            children: data.map((item, index) => {
              return {
                type: "group",
                left: index * 110, // 距离父容器左侧的位置
                top: "50",
                children: [
                  // Series 1 的颜色块
                  {
                    type: "rect",
                    shape: {
                      width: 10, // 颜色块宽度
                      height: 30, // 颜色块高度
                    },
                    style: {
                      fill: item.itemStyle.color, // Series 1 的颜色，与 series 配置中的颜色对应
                      stroke: null, // 不显示边框
                    },
                    silent: true, // 不响应鼠标事件
                  },
                  // Series 1 的文本
                  {
                    type: "text",
                    left: "15", // 距离颜色块右侧的位置
                    style: {
                      text: `${item.name}`, // 自定义文本内容
                      fill: "black", // 文本颜色
                      textAlign: "left", // 文本对齐方式
                    },
                  },
                  {
                    type: "text",
                    left: "15", // 距离颜色块右侧的位置
                    top: "20",
                    style: {
                      text: `${item.description}`, // 自定义文本内容
                      fill: "black", // 文本颜色
                      textAlign: "left", // 文本对齐方式
                    },
                  },
                ],
              };
            }),
          },
          series: data,
        };
        myChart.setOption(option);
      }
      window.onload = function () {
        // 请求数据
        getUmberllaData(url).then((data) => {

          // 绘制图表
          initEchart(data)
        });
      };
    </script>
    <style>
      #chartContainer {
        width: 100%;
        height: 363px;
      }
    </style>
  </head>
  <body>
    <div id="chartContainer"></div>
  </body>
</html>
